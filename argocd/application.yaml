########################
# Argo CD Application for GlobalSend
# - Deploys Helm chart from GitOps repo
# - Targets 'globalsend' namespace (must exist beforehand)
# - Automated sync with prune and self-heal enabled
########################
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: globalsend
  namespace: argocd
spec:
  project: default

  source:
    repoURL: https://github.com/tecknosap/globalsend-k8-gitops.git
    targetRevision: main
    path: helm/globalsend

  destination:
    server: https://kubernetes.default.svc
    namespace: globalsend  # <--- removed createNamespace

  syncPolicy:
    automated:
      prune: true
      selfHeal: true